<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    border: 1px solid #d3d3d3;
    background-color: #f1f1f1;
    float: left;
}

#settings-panel {
    background-color: #f1f1f1;
    margin-left: 10px;
    width: 200px;
    height: 500px;
    display: inline-block;
    border: 1px solid #d3d3d3;
    padding: 10px;
}
</style>
</head>
<body onload="startGame()">

<script src="js/Drawable.js"></script>
<script src="js/Terminal.js"></script>
<script src="js/Applicable.js"></script>
<script src="js/Gate.js"></script>
<script src="js/Led.js"></script>
<script src="js/Switch.js"></script>
<script src="js/Wire.js"></script>
<script src="js/Clock.js"></script>
<script src="js/Component.js"></script>

<script src="js/gates/NotGate.js"></script>
<script src="js/gates/NandGate2.js"></script>
<script src="js/gates/NandGate3.js"></script>
<script src="js/gates/NandGate4.js"></script>
<script src="js/gates/NorGate2.js"></script>
<script src="js/gates/NorGate3.js"></script>

<script src="js/components/Mux81.js"></script>
<script src="js/components/Decoder.js"></script>
<script src="js/components/Decoder74HC138.js"></script>
<script src="js/components/Decoder74HC238.js"></script>
<script src="js/components/Display16.js"></script>
<script src="js/components/FlipFlopJK.js"></script>
<script src="js/components/FlipFlopD.js"></script>
<script src="js/components/Counter74HC193.js"></script>
<script src="js/components/Counter74HC190.js"></script>
<script src="js/components/Register.js"></script>

<script src="js/Board.js"></script>
<script src="js/boards/BoardInput.js"></script>
<script src="js/boards/BoardGates.js"></script>
<script src="js/boards/BoardLeds.js"></script>
<script src="js/boards/BoardMux.js"></script>
<script src="js/boards/BoardSequential.js"></script>

<script src="js/Game.js"></script>
<script>

var game;

var refreshtime = 20;
var clocktime = 500;

var clockinterval = undefined;
var refreshinterval = undefined;

function setGameUpdate() {
    if (refreshinterval !== undefined) {
        clearInterval(refreshinterval);
    }
    refreshinterval = window.setInterval(function(){
        game.update();
    }, refreshtime);
}

function setClock() {
    if (clockinterval !== undefined) {
        clearInterval(clockinterval);
    }
    clockinterval = window.setInterval(function(){
        var inp = game.boards[0];
        var clk = inp.gates[inp.gates.length-1];
        clk.toggle();
    }, clocktime);
}

function startGame() {
    game = new Game();
    setGameUpdate();
    setClock();
}

function settings_changeClock() {
    var value = document.getElementById("clock").value;
    clocktime = 1000+20-value;
    setClock();
}

</script>

<canvas id="canvas" width="1650" height="920"></canvas>
<div id="settings-panel">
    <div class="settings-panel__section">
        <label for="clock">Clock frequency:</label>
        <input onchange="settings_changeClock()" value="500" type="range" id="clock" name="clock" min="20" max="1000" step="20">
    </div>
</div>
</body>
</html>
